package vista;

import aplicacion.Empresa;
import aplicacion.Inversor;
import aplicacion.Regulador;
import aplicacion.Usuario;
import org.w3c.dom.Text;
import vista.componentes.DialogoInfo;
import vista.componentes.FuentesGUI;
import vista.componentes.ImagenesGUI;
import vista.componentes.TextBox;

import javax.swing.*;
import java.util.ArrayList;
import java.util.List;


public class VRegistro extends javax.swing.JFrame {

    aplicacion.FachadaAplicacion fa;

    public VRegistro(aplicacion.FachadaAplicacion fa) {
        this.fa = fa;
        initComponents();
        configureComponentes();
        setExtendedState(this.getExtendedState() | JFrame.MAXIMIZED_BOTH);
        this.setIconImage(ImagenesGUI.getImage("database.png", 128));
        this.setTitle("Mercado de Valores - Iniciar sesión");
        this.setValidators();
    }

    private void setValidators() {
        // Validación del registro
        tlfoReg.setValidator(s -> {
            if (s.length() == 0) // admitimos nulos
                return true;
            try {
                Integer.parseInt(s);
                return s.length() == 9; // debe ser un entero de 9 cifras si no es nulo
            } catch (NumberFormatException e) {
                return false;
            }
        });
        IDReg.setValidator(s -> s.length() > 2 && s.length() <= 20); // minimo 3, maximo 20
        nombreReg.setValidator(s -> s.length() > 2 && s.length() <= 60); // minimo 3, maximo 60
        direccionReg.setValidator(s -> s.length() <= 50); // 50 como mucho, adminitimos nulos
        CIFReg.setValidator(s -> s.length() == 9); // debe ser 9, no admitimos nulos
        // TODO
        // Refinar esto más adelante, debería haber un validador general de contraseñas
        // con requisitos más elaborados
        claveReg.setValidator(s -> s.length() > 2 && s.length() <= 10);

        // Validadores del login
        ingresoUsuario.setValidator(s -> s.length() > 2 && s.length() <= 60); // minimo 3, maximo 60
        ingresoClave.setValidator(s -> s.length() > 2 && s.length() <= 10);
    }

    private void configureComponentes() {
        // Configura los componentes introducidos
        ingresoLabel.setFont(FuentesGUI.getFuente(
                FuentesGUI.Modificador.NORMAL, FuentesGUI.Size.TITULO));
        registroLabel.setFont(FuentesGUI.getFuente(
                FuentesGUI.Modificador.NORMAL, FuentesGUI.Size.TITULO));
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        botonCrearSolicitud = new vista.componentes.Boton();
        claveIngresoLabel = new vista.componentes.Etiqueta();
        ingresoLabel = new vista.componentes.Etiqueta();
        telefonoRegLabel = new vista.componentes.Etiqueta();
        registroLabel = new vista.componentes.Etiqueta();
        usuarioIngresoLabel = new vista.componentes.Etiqueta();
        tipoRegLabel = new vista.componentes.Etiqueta();
        nombreRegLabel = new vista.componentes.Etiqueta();
        CIFRegLabel = new vista.componentes.Etiqueta();
        idRegLabel = new vista.componentes.Etiqueta();
        claveRegLabel = new vista.componentes.Etiqueta();
        direccionRegLabel = new vista.componentes.Etiqueta();
        ingresoUsuario = new vista.componentes.TextBox();
        nombreReg = new vista.componentes.TextBox();
        CIFReg = new vista.componentes.TextBox();
        botonAceptarIngreso = new vista.componentes.Boton();
        IDReg = new vista.componentes.TextBox();
        tlfoReg = new vista.componentes.TextBox();
        direccionReg = new vista.componentes.TextBox();
        botonSalir = new vista.componentes.BotonVolver();
        ingresoClave = new vista.componentes.PasswordField();
        claveReg = new vista.componentes.PasswordField();
        String[] tipos = {"Inversor", "Empresa"};
        tipoReg = new vista.componentes.SelecionBox(tipos);

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        botonCrearSolicitud.setText("Crear solicitud de registro");
        botonCrearSolicitud.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                solicitarRegistroActionPerformed(evt);
            }
        });

        claveIngresoLabel.setText("Clave:");

        ingresoLabel.setText("Ingreso");

        telefonoRegLabel.setText("Teléfono:");

        registroLabel.setText("Registro");

        usuarioIngresoLabel.setText("Usuario:");

        tipoRegLabel.setText("Tipo:");

        nombreRegLabel.setText("Nombre:");

        CIFRegLabel.setText("CIF/DNI:");

        idRegLabel.setText("ID de usuario:");

        claveRegLabel.setText("Clave:");

        direccionRegLabel.setText("Dirección:");

        ingresoUsuario.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ingresoUsuarioActionPerformed(evt);
            }
        });

        nombreReg.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                nombreRegActionPerformed(evt);
            }
        });

        CIFReg.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CIFRegActionPerformed(evt);
            }
        });

        botonAceptarIngreso.setText("Aceptar");
        botonAceptarIngreso.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonAceptarIngresocancelarRegistroActionPerformed(evt);
            }
        });

        IDReg.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                IDRegActionPerformed(evt);
            }
        });

        tlfoReg.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tlfoRegActionPerformed(evt);
            }
        });

        direccionReg.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                direccionRegActionPerformed(evt);
            }
        });

        botonSalir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botonSalirActionPerformed(evt);
            }
        });

        ingresoClave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ingresoClaveActionPerformed(evt);
            }
        });

        claveReg.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                claveRegActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(layout.createSequentialGroup()
                                                .addContainerGap(248, Short.MAX_VALUE)
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                        .addComponent(ingresoLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addComponent(usuarioIngresoLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                                                .addComponent(botonAceptarIngreso, javax.swing.GroupLayout.PREFERRED_SIZE, 132, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addGroup(layout.createSequentialGroup()
                                                                        .addComponent(claveIngresoLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                        .addGap(48, 48, 48)
                                                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                                                                .addComponent(ingresoUsuario, javax.swing.GroupLayout.DEFAULT_SIZE, 200, Short.MAX_VALUE)
                                                                                .addComponent(ingresoClave, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))))
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 201, Short.MAX_VALUE)
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                        .addComponent(direccionRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addComponent(claveRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addComponent(idRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addComponent(telefonoRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addComponent(CIFRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addComponent(nombreRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addComponent(tipoRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addComponent(registroLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                                .addGap(18, 18, 18))
                                        .addGroup(layout.createSequentialGroup()
                                                .addGap(42, 42, 42)
                                                .addComponent(botonSalir, javax.swing.GroupLayout.PREFERRED_SIZE, 128, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(botonCrearSolicitud, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 386, Short.MAX_VALUE)
                                        .addComponent(direccionReg, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(IDReg, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(tlfoReg, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(CIFReg, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(nombreReg, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(claveReg, javax.swing.GroupLayout.DEFAULT_SIZE, 386, Short.MAX_VALUE)
                                        .addComponent(tipoReg, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                .addGap(225, 225, 225))
        );
        layout.setVerticalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(layout.createSequentialGroup()
                                .addGap(85, 85, 85)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                        .addComponent(registroLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(ingresoLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(69, 69, 69)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                        .addComponent(usuarioIngresoLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(ingresoUsuario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(tipoRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(tipoReg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                        .addComponent(claveIngresoLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(nombreRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(nombreReg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(ingresoClave, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                        .addComponent(CIFReg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(CIFRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(botonAceptarIngreso, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(layout.createSequentialGroup()
                                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                                        .addComponent(telefonoRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addComponent(tlfoReg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                                .addGap(18, 18, 18)
                                                .addComponent(IDReg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addGroup(layout.createSequentialGroup()
                                                .addGap(49, 49, 49)
                                                .addComponent(idRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addGap(18, 18, 18)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(claveRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(claveReg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                                        .addComponent(direccionRegLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(direccionReg, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(layout.createSequentialGroup()
                                                .addGap(35, 35, 35)
                                                .addComponent(botonCrearSolicitud, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                                .addComponent(botonSalir, javax.swing.GroupLayout.PREFERRED_SIZE, 128, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGap(31, 31, 31))))
        );

        botonSalir.configurar(fa, this, true);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void solicitarRegistroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_solicitarRegistroActionPerformed
        this.solicitarRegistro();
    }//GEN-LAST:event_solicitarRegistroActionPerformed

    private void botoncancelarRegistroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_boton2cancelarRegistroActionPerformed
    }//GEN-LAST:event_boton2cancelarRegistroActionPerformed

    private void ingresoUsuarioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ingresoUsuarioActionPerformed
    }//GEN-LAST:event_ingresoUsuarioActionPerformed

    private void nombreRegActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_nombreRegActionPerformed
    }//GEN-LAST:event_nombreRegActionPerformed

    private void CIFRegActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CIFRegActionPerformed
    }//GEN-LAST:event_CIFRegActionPerformed

    private void botonAceptarIngresocancelarRegistroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonAceptarIngresocancelarRegistroActionPerformed
        this.login();
    }//GEN-LAST:event_botonAceptarIngresocancelarRegistroActionPerformed

    private void IDRegActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_IDRegActionPerformed
    }//GEN-LAST:event_IDRegActionPerformed

    private void tlfoRegActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tlfoRegActionPerformed
    }//GEN-LAST:event_tlfoRegActionPerformed

    private void direccionRegActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_direccionRegActionPerformed
    }//GEN-LAST:event_direccionRegActionPerformed

    private void botonSalirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botonSalirActionPerformed
    }//GEN-LAST:event_botonSalirActionPerformed

    private void ingresoClaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ingresoClaveActionPerformed
    }//GEN-LAST:event_ingresoClaveActionPerformed

    private void claveRegActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_claveRegActionPerformed
    }//GEN-LAST:event_claveRegActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private vista.componentes.TextBox CIFReg;
    private vista.componentes.Etiqueta CIFRegLabel;
    private vista.componentes.TextBox IDReg;
    private vista.componentes.Boton botonAceptarIngreso;
    private vista.componentes.Boton botonCrearSolicitud;
    private vista.componentes.BotonVolver botonSalir;
    private vista.componentes.Etiqueta claveIngresoLabel;
    private vista.componentes.PasswordField claveReg;
    private vista.componentes.Etiqueta claveRegLabel;
    private vista.componentes.TextBox direccionReg;
    private vista.componentes.Etiqueta direccionRegLabel;
    private vista.componentes.Etiqueta idRegLabel;
    private vista.componentes.PasswordField ingresoClave;
    private vista.componentes.Etiqueta ingresoLabel;
    private vista.componentes.TextBox ingresoUsuario;
    private vista.componentes.TextBox nombreReg;
    private vista.componentes.Etiqueta nombreRegLabel;
    private vista.componentes.Etiqueta registroLabel;
    private vista.componentes.Etiqueta telefonoRegLabel;
    private vista.componentes.SelecionBox tipoReg;
    private vista.componentes.Etiqueta tipoRegLabel;
    private vista.componentes.TextBox tlfoReg;
    private vista.componentes.Etiqueta usuarioIngresoLabel;
    // End of variables declaration//GEN-END:variables

    /**
     * Valida el usuario a partir de los datos del formulario de ingreso.
     * Abre el menú correspondiente a su tipo y cierra esta ventana si la validación es correcta
     */
    public void login() {

        if (!ingresoUsuario.validateInput() | !ingresoClave.validateInput()) {
            fa.muestraExcepcion("Alguno de los campos de entrada no es correcto!",
                    DialogoInfo.NivelDeAdvertencia.ADVERTENCIA);
            return;
        }

        String nombreU, password;

        nombreU = ingresoUsuario.getText();
        password = ingresoClave.getText();
        Usuario user = fa.validarUsuario(ingresoUsuario.getText(), ingresoClave.getText());

        // (No hace falta comprobar si es nulo antes de hacer instanceof)
        if (user instanceof Inversor) {
            fa.menuInversor((Inversor) user);
            System.out.println("Usuario encontrado, es inversor");
            this.dispose();
        } else if (user instanceof Empresa) {
            fa.menuEmpresa((Empresa) user);
            System.out.println("Usuario encontrado, es empresa");
            this.dispose();
        } else if (user instanceof Regulador) {
            fa.menuRegulador((Regulador) user);
            System.out.println("Usuario encontrado, es regulador");
            this.dispose();
        }
    }

    public void solicitarRegistro() {
        boolean inversor = false, empresa = false;

        if (!IDReg.validateInput() | !direccionReg.validateInput() | !CIFReg.validateInput()
                | !nombreReg.validateInput() | !claveReg.validateInput() | !tlfoReg.validateInput()) {
            fa.muestraExcepcion("Alguno de los campos del registro no es correcto!",
                    DialogoInfo.NivelDeAdvertencia.ADVERTENCIA);
            return;
        }

        switch (this.tipoReg.getSelectedIndex()) {//switch segun el elemento seleccionado en el combobox
            case 0: {
                //si en el comboBox de selecion de tipo tiene el index 1, es que es inversor
                Inversor i;
                //creo el inversor
                i = new Inversor(this.IDReg.getText(), this.nombreReg.getText(), this.CIFReg.getText(), this.direccionReg.getText(), this.tlfoReg.getText(), 0.0f, this.claveReg.getText(), false, false);
                inversor = fa.registroInversor(i);//hace lo mismo que la de registro de usuarios (el comprobar que el id no esta en uso es paranoia, nunca debe estarlo si llegas aqui)

                break;
            }
            case 1: {
                //si en el comboBox de selecion de tipo tiene el index 0, es que es empresa
                Empresa e;
                //creo la empresa
                e = new Empresa(this.IDReg.getText(), this.nombreReg.getText(), this.CIFReg.getText(), 0.0f, 0.0f, this.direccionReg.getText(), this.tlfoReg.getText(), this.claveReg.getText(), false, false);
                empresa = fa.registroEmpresa(e);//hace lo mismo que la de registro de usuarios (el comprobar que el id no esta en uso es paranoia, nunca debe estarlo si llegas aqui)
                break;
            }
            default:
                fa.muestraExcepcion("Debes seleccionar el tipo de registro que quieres: empresa o inversor.",
                        DialogoInfo.NivelDeAdvertencia.ADVERTENCIA);//muestro excepcion
                break;
        }

        if (inversor)
            fa.muestraExcepcion("Se ha enviado la solicitud de registro del inversor "
                    + nombreReg.getText() + " correctamente!", DialogoInfo.NivelDeAdvertencia.INFORMACION);
        else if (empresa)
            fa.muestraExcepcion("Se ha enviado la solicitud de registro de la empresa "
                    + nombreReg.getText() + " correctamente!", DialogoInfo.NivelDeAdvertencia.INFORMACION);
        else // Solo falla aquí si el ID estaba mal
            fa.muestraExcepcion("El ID \"" + IDReg.getText() + "\" ya está en uso!");

    }
}
